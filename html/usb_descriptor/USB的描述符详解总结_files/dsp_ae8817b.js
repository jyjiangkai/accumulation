define("wkcommon:widget/ui/lib/ad/dsp.js",function(e,o,t){var a=e("wkcommon:widget/ui/lib/ad/idMap.js"),i={wkhomepagetopic:{}},n=0,r={},p=[],s=function(e){n=2;for(var o=0;o<p.length;o++){var t=p[o]||{};"function"==typeof t.resolve&&t.resolve(e)}p=[]},c=function(){n=3;for(var e=0;e<p.length;e++){var o=p[e]||{};"function"==typeof o.resolve&&o.resolve({})}p=[]},d=function(){switch(n){case 2:s(r);break;case 3:c()}},f=function(e){if(e){var o=new Image;o.src=e}},u=function(e){var o=[],t=new $.Deferred;
if(!e.page)return t;p.push(t);for(var u=a[e.page]||[],g=0;g<u.length;g++)i[u[g].datakey]||(i[u[g].datakey]={}),i[u[g].datakey][u[g].slotid]?r[u[g].slotid]=i[u[g].datakey][u[g].slotid]||{}:(r[u[g].slotid]={},o.push(u[g].slotid));var k=o.join(",");return 0===n&&o.length>0?(n=1,$.ajax({type:"post",url:"https://eduad.baidu.com/bidding/wenku_post_json",data:JSON.stringify({slotid:k,wkkeyword:e.params.wkkeyword}),contentType:"text/plain",dataType:"json",success:function(e){if(e.wkhomepagetopic)for(var t=0;t<e.wkhomepagetopic.length;t++){var a=e.wkhomepagetopic[t].impidx,n=o[a];
r[n]=e.wkhomepagetopic[t],i.wkhomepagetopic[n]=e.wkhomepagetopic[t];var p=e.wkhomepagetopic[t].impurl||"";""!==p&&f(p)}s(r)},error:function(){c({})}})):2===n&&d(),t.promise()};t.exports={fetchData:u}});